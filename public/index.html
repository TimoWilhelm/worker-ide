<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Worker IDE</title>
		<link rel="stylesheet" href="/styles.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css" />
	</head>
	<body>
		<div class="app">
			<header class="header">
				<div class="logo">
					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polygon points="12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2"></polygon>
						<line x1="12" y1="22" x2="12" y2="15.5"></line>
						<polyline points="22 8.5 12 15.5 2 8.5"></polyline>
					</svg>
					<span>Worker IDE</span>
				</div>
				<div id="collabIndicator" class="collab-indicator" style="display: none"></div>
				<div class="actions">
					<a href="/about" target="_blank" class="btn btn-secondary" title="About">
						<svg
							width="16"
							height="16"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<circle cx="12" cy="12" r="10"></circle>
							<line x1="12" y1="16" x2="12" y2="12"></line>
							<line x1="12" y1="8" x2="12.01" y2="8"></line>
						</svg>
					</a>
					<a
						href="https://github.com/TimoWilhelm/worker-ide"
						target="_blank"
						rel="noopener noreferrer"
						class="btn btn-secondary"
						title="GitHub"
					>
						<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
							<path
								d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"
							/>
						</svg>
					</a>
					<button id="shareBtn" class="btn btn-secondary" title="Copy Share Link">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<circle cx="18" cy="5" r="3"></circle>
							<circle cx="6" cy="12" r="3"></circle>
							<circle cx="18" cy="19" r="3"></circle>
							<line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
							<line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
						</svg>
					</button>
					<button id="downloadBtn" class="btn btn-secondary" title="Download Project">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
							<polyline points="7 10 12 15 17 10"></polyline>
							<line x1="12" y1="15" x2="12" y2="3"></line>
						</svg>
					</button>
					<div class="recent-projects-wrapper">
						<button id="recentProjectsBtn" class="btn btn-secondary" title="Recent Projects">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<circle cx="12" cy="12" r="10"></circle>
								<polyline points="12 6 12 12 16 14"></polyline>
							</svg>
						</button>
						<div id="recentProjectsDropdown" class="recent-dropdown hidden"></div>
					</div>
					<button id="newProjectBtn" class="btn btn-secondary" title="New Project">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<line x1="12" y1="5" x2="12" y2="19"></line>
							<line x1="5" y1="12" x2="19" y2="12"></line>
						</svg>
					</button>
					<button id="refreshBtn" class="btn btn-secondary" title="Refresh Preview">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<polyline points="23 4 23 10 17 10"></polyline>
							<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
						</svg>
					</button>
					<button id="aiToggleBtn" class="btn btn-primary" title="AI Assistant">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path
								d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"
							></path>
							<circle cx="7.5" cy="14.5" r="1.5"></circle>
							<circle cx="16.5" cy="14.5" r="1.5"></circle>
						</svg>
						<span class="ai-btn-label">AI</span>
					</button>
				</div>
			</header>
			<main class="main">
				<aside class="sidebar">
					<div class="sidebar-header">
						<span>Files</span>
						<button id="newFileBtn" class="btn-icon" title="New File">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="12" y1="5" x2="12" y2="19"></line>
								<line x1="5" y1="12" x2="19" y2="12"></line>
							</svg>
						</button>
					</div>
					<div id="fileTree" class="file-tree"></div>
				</aside>
				<div class="mobile-toggle" id="mobileToggle">
					<button class="mobile-toggle-btn active" data-panel="editor">Editor</button>
					<button class="mobile-toggle-btn" data-panel="preview">Preview</button>
					<button class="mobile-toggle-btn" data-panel="ai">AI</button>
				</div>
				<section class="editor-panel">
					<div class="tabs" id="tabs"></div>
					<div class="editor-container">
						<textarea id="editor"></textarea>
					</div>
					<div class="status-bar">
						<span id="fileStatus">No file selected</span>
						<span id="saveStatus"></span>
					</div>
				</section>
				<section class="preview-panel">
					<div class="preview-header">
						<span>Preview</span>
						<span id="previewUrl" class="preview-url">/preview</span>
					</div>
					<iframe id="previewFrame" src="about:blank" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>
				</section>
				<aside class="ai-sidebar hidden" id="aiSidebar">
					<div class="ai-sidebar-header">
						<span>AI Assistant</span>
						<div class="ai-header-actions">
							<div class="ai-session-switcher">
								<button id="aiSessionListBtn" class="btn-icon" title="Sessions">
									<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<line x1="8" y1="6" x2="21" y2="6"></line>
										<line x1="8" y1="12" x2="21" y2="12"></line>
										<line x1="8" y1="18" x2="21" y2="18"></line>
										<line x1="3" y1="6" x2="3.01" y2="6"></line>
										<line x1="3" y1="12" x2="3.01" y2="12"></line>
										<line x1="3" y1="18" x2="3.01" y2="18"></line>
									</svg>
								</button>
								<div id="aiSessionDropdown" class="ai-session-dropdown hidden"></div>
							</div>
							<button id="aiNewSessionBtn" class="btn-icon" title="New session">
								<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<line x1="12" y1="5" x2="12" y2="19"></line>
									<line x1="5" y1="12" x2="19" y2="12"></line>
								</svg>
							</button>
							<button id="aiSidebarClose" class="btn-icon" title="Close">
								<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<line x1="18" y1="6" x2="6" y2="18"></line>
									<line x1="6" y1="6" x2="18" y2="18"></line>
								</svg>
							</button>
						</div>
					</div>
					<div class="ai-messages" id="aiMessages">
						<div class="ai-welcome">
							<div class="ai-welcome-icon">
								<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
									<path
										d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"
									></path>
									<circle cx="7.5" cy="14.5" r="1.5"></circle>
									<circle cx="16.5" cy="14.5" r="1.5"></circle>
								</svg>
							</div>
							<p>Ask me to help with your code. I can read, create, edit, and delete files in your project.</p>
							<div class="ai-suggestions">
								<button class="ai-suggestion" data-prompt="Add a dark mode toggle to the app">Add dark mode</button>
								<button class="ai-suggestion" data-prompt="Explain what this project does">Explain project</button>
								<button class="ai-suggestion" data-prompt="Add form validation to the input fields">Add validation</button>
							</div>
						</div>
					</div>
					<div class="ai-status hidden" id="aiStatus">
						<span class="ai-status-dot"></span>
						<span class="ai-status-text"></span>
					</div>
					<div class="ai-input-container">
						<textarea id="aiPrompt" placeholder="Ask the AI to help..." rows="1"></textarea>
						<button id="aiSend" class="btn btn-primary" title="Send">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="22" y1="2" x2="11" y2="13"></line>
								<polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
							</svg>
						</button>
						<button id="aiStopBtn" class="btn btn-stop hidden" title="Stop">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<rect x="6" y="6" width="12" height="12" rx="2"></rect>
							</svg>
						</button>
					</div>
				</aside>
			</main>
			<div class="terminal-panel" id="terminalPanel">
				<div class="terminal-header">
					<div class="terminal-tabs">
						<span class="terminal-tab active">Server Console</span>
					</div>
					<div class="terminal-actions">
						<span id="errorBadge" class="terminal-badge badge-error hidden">0</span>
						<span id="warnBadge" class="terminal-badge badge-warn hidden">0</span>
						<span id="logBadge" class="terminal-badge badge-log hidden">0</span>
						<button id="clearTerminalBtn" class="btn-icon" title="Clear">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<circle cx="12" cy="12" r="10"></circle>
								<line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
							</svg>
						</button>
						<button id="toggleTerminalBtn" class="btn-icon" title="Toggle Terminal">
							<svg
								class="toggle-terminal-icon"
								width="14"
								height="14"
								viewBox="0 0 24 24"
								fill="none"
								stroke="currentColor"
								stroke-width="2"
							>
								<polyline points="6 9 12 15 18 9"></polyline>
							</svg>
						</button>
					</div>
				</div>
				<div class="terminal-body" id="terminalBody">
					<div class="terminal-output" id="terminalOutput"></div>
				</div>
			</div>
		</div>

		<div id="modal" class="modal hidden">
			<div class="modal-content">
				<div class="modal-header">
					<span id="modalTitle">New File</span>
					<button id="modalClose" class="btn-icon">Ã—</button>
				</div>
				<div class="modal-body">
					<input type="text" id="modalInput" placeholder="Enter file path (e.g. /src/utils.js)" />
				</div>
				<div class="modal-footer">
					<button id="modalCancel" class="btn btn-secondary">Cancel</button>
					<button id="modalConfirm" class="btn btn-primary">Create</button>
				</div>
			</div>
		</div>

		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/css/css.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/htmlmixed/htmlmixed.min.js"></script>
		<script src="/app.js"></script>
	</body>
</html>
